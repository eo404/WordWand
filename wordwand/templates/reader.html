{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>WordWand ‚Äì Read & Listen</title>

    <!-- Board + Scene CSS -->
    <link rel="stylesheet" href="{% static 'css/tts_engine.css' %}">

    <!-- Your Original Reader CSS -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
</head>

<body>

    <!-- Bunting -->
    <img src="{% static 'images/banner.png' %}" class="bunting">

    <!-- Teacher -->
    <img src="{% static 'images/teacher.png' %}" class="teacher">

    <!-- CENTER AREA -->
    <main>

        <!-- CHALK BOARD -->
        <div class="main-board">

            <!-- YOUR ORIGINAL READER CONTENT (UNCHANGED) -->
            <div class="container">

                <h2>Read & Listen </h2>

                <div class="upload-section">
                    <form method="POST" enctype="multipart/form-data" class="chalk-upload-form">
                        {% csrf_token %}
                
                        <!-- Hidden real input -->
                        <input type="file" id="fileInput" name="file" required hidden>
                
                        <!-- Custom Button -->
                        <label for="fileInput" class="chalk-btn">Choose File</label>
                
                        <!-- File Name Display -->
                        <span id="fileName" class="file-name"></span>
                
                        <!-- Submit -->
                        <button type="submit" class="chalk-btn-outline">Read File</button>
                    </form>
                </div>

                {% if error %}
                <div class="error-message">{{ error }}</div>
                {% endif %}

                {% if text %}
                <div class="text-display-section">
                    <h3>üìñ Detected Text</h3>
                    <div id="text-container"></div>
                </div>

                <div class="control-panel">
                    <button onclick="readNormal()">‚ñ∂ Read</button>
                    <button onclick="readSlow()">Slow</button>
                    <button onclick="stopSpeech()">‚èπ Stop</button>
                </div>
                {% endif %}

            </div>

        </div>

    </main>

    <!-- DATA TO JS -->
    <script>
        const OCR_TEXT = "{{ text|escapejs }}";
        const HARD_WORDS = JSON.parse('{{ hard_words|escapejs|default:"[]" }}');
        const SYLLABLES = JSON.parse('{{ syllables|escapejs|default:"{}" }}');
    </script>

    <!-- POPUP -->
    <div id="word-popup" class="popup hidden">
        <div class="popup-content" onclick="event.stopPropagation();">
            <span class="close-btn" onclick="closePopup()">‚úñ</span>
            <h2 id="popup-word"></h2>
            <div id="letter-box"></div>
            <div style="margin-top: 20px;">
                <button onclick="speakPopupWord()">Hear Again</button>
                <button onclick="closePopup()">Close</button>
            </div>
        </div>
    </div>

    <script src="{% static 'js/tts_engine.js' %}"></script>

</body>
</html>